{{> customer_header }}

<div class="customer-content">
    {{> form_errors}}

    <form class="form-horizontal" method="post" action=''>
        {{> input type='text' name='name' label=i18n.name }}
        {{> input type='text' name='surname' label=i18n.surname }}
        {{> input_and_checkbox type='tel' name='mobile_phone' label=i18n.mobile_phone cbname='allow_sms' cblabel=i18n.allow_sms}}

        {{> input type='tel' name='phone' label=i18n.phone }}
        {{> input_and_checkbox type='email' name='email' label=i18n.email cbname='allow_email' cblabel=i18n.allow_email}}

        <div class="form-group">
            <label class="control-label col-sm-2" for='discount'>{{i18n.discount}}</label>
            <div class="col-sm-8">
                <label class="radio-inline">
                    <input type="radio" name="discount" value="0">0%</input>
                </label>
                <label class="radio-inline">
                    <input type="radio" name="discount" value="10">10%</input>
                </label>
                <label class="radio-inline">
                    <input type="radio" name="discount" value="20">20%</input>
                </label>
                <label class="radio-inline">
                    <input type="radio" name="discount" value="30">30%</input>
                </label>
            </div>
        </div>
        {{> input_date name='first_see' label=i18n.first_see}}
        {{> input_date name='last_see' label=i18n.last_see}}
        <input type='hidden' name="_csrf" value="{{csrftoken}}">
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <button type="submit" class="btn btn-primary" name="submit">Submit</button>
            </div>
        </div>
        <script type="text/javascript">
            var Customer = (function() {
                /// Private variables and functions

                var customerData = {{{json obj}}};
                var dateFormat = "{{config.date_format}}".toLowerCase();
                var language = '{{config.language}}';

                var init = function() {
                    $.fn.datepicker.defaults.format = dateFormat;

                    $('form input').each(function() {
                        var name = $(this).attr('name');
                        if (typeof customerData[name] !== 'undefined') {
                            if (name == 'first_see' || name == 'last_see') {
                                $('#' + name + '-container .input-group.date').datepicker(
                                    'setDate', customerData[name]);
                            }
                            else if (name == 'allow_sms' || name == 'allow_email') {
                                if (customerData[name])
                                    $(this).attr('checked', 'checked');
                            }
                            else {
                                $(this).val(customerData[name]);
                            }
                        }
                    });
                    $('#first_see-container .input-group.date').datepicker({
                        language: language,
                        format: dateFormat,
                        weekStart: 1,
                        daysOfWeekDisabled: "0",
                        autoclose: true,
                        todayHighlight: true,
                        endDate: "0d"
                    });
                    $('#last_see-container .input-group.date').datepicker({
                        language: language,
                        format: dateFormat,
                        weekStart: 1,
                        daysOfWeekDisabled: "0",
                        autoclose: true,
                        todayHighlight: true,
                        endDate: "0d"
                    });
                };

                /// Public API
                return {
                    init: init
                };

            })();

            $(document).ready(Customer.init());
        </script>
    </form>
</div>

